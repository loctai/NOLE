
{% extends "main/layouts/base.html" %}

{% block title %} <title>NOLE | Contact Us</title> {% endblock title %}

{% block stylesheets %}{% endblock stylesheets %}

{% block content %}
<div class="base_wrapper promotion_program">
    <h2 class="title">Contact Us</h2> <br />
    <div class="mail-box">
        {% if data_detail == None %}
        <div class="mail-box_head">        
            <button class="big_button link_copy _modal-trigger" data-_modal="_modal-contacts" data-link="https://nole.ai/?ref=QT19024806" data-base-text="Get the link" data-copied-text="Copied!">
                <i class="icon">
                    <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-envelope-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" d="M.05 3.555A2 2 0 0 1 2 2h12a2 2 0 0 1 1.95 1.555L8 8.414.05 3.555zM0 4.697v7.104l5.803-3.558L0 4.697zM6.761 8.83l-6.57 4.027A2 2 0 0 0 2 14h12a2 2 0 0 0 1.808-1.144l-6.57-4.027L8 9.586l-1.239-.757zm3.436-.586L16 11.801V4.697l-5.803 3.546z"/>
                      </svg>    
                </i>
                <span class="btn_text">New Contact</span>
            </button>
        </div>
        {% endif %}
        <div class="mail-box_body">
            {% if data_detail %}
                <div class="mail-box_content">
                    <div class="mail-box_content-head">
                        {{data_detail.subject}}
                    </div>
                    {% for item in data_detail.content %}
                    <div class="mail-box_content-item">
                        <div class="mail-box_content-name">
                            <div class="m_name">
                                {% if (item.name == "You") %}
                                {{item.name}} 
                                <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-arrow-right-short" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd" d="M4 8a.5.5 0 0 1 .5-.5h5.793L8.146 5.354a.5.5 0 1 1 .708-.708l3 3a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708-.708L10.293 8.5H4.5A.5.5 0 0 1 4 8z"/>
                                </svg>
                                Nole Support
                                {% else %}
                                    {{item.name}} 
                                    <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-arrow-right-short" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path fill-rule="evenodd" d="M4 8a.5.5 0 0 1 .5-.5h5.793L8.146 5.354a.5.5 0 1 1 .708-.708l3 3a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708-.708L10.293 8.5H4.5A.5.5 0 0 1 4 8z"/>
                                    </svg>
                                    You
                                {% endif %}
                            </div>
                            <div class="m_date">
                                {{item.date | date_format}}
                            </div>
                        </div>
                        <div class="mail-box_content-detail">
                            {{item.msg}}
                        </div>
                    </div>
                    {% endfor %}
                    
                    <div class="btn_reply">
                        <button class="big_button link_copy _modal-trigger" data-_modal="_modal-contacts-edit" data-link="https://nole.ai/?ref=QT19024806" data-base-text="Get the link" data-copied-text="Copied!">
                            <i class="icon">
                                <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-envelope-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd" d="M.05 3.555A2 2 0 0 1 2 2h12a2 2 0 0 1 1.95 1.555L8 8.414.05 3.555zM0 4.697v7.104l5.803-3.558L0 4.697zM6.761 8.83l-6.57 4.027A2 2 0 0 0 2 14h12a2 2 0 0 0 1.808-1.144l-6.57-4.027L8 9.586l-1.239-.757zm3.436-.586L16 11.801V4.697l-5.803 3.546z"/>
                                </svg>    
                            </i>
                            <span class="btn_text">Reply</span>
                        </button>
                    </div>
                </div>
            {%else%}
                {% for item in data %}
                {% if (item.read == 0) %}
                <div class="mail-box_list active">
                {% else %}
                <div class="mail-box_list">
                {% endif %}
                    <div class="mail-box_list-subject">
                        <a class="view-detail" href="/account/contact-us/{{item._id}}">Detail</a>
                        <a href="/account/contact-us/{{item._id}}">{{item.subject}}</a>
                    </div>
                    <div class="mail-box_list-date">
                        <span>{{item.createdAt | date_format }}</span>
                        
                    </div>
                </div>
                {% endfor %}
            {%endif%}
           
        </div>
    </div>
    
</div>

</div>

<!-- _modal -->
<div class="_modal" id="_modal-contacts">
    <div class="_modal-sandbox"></div>
    <div class="_modal-box">
        <div class="_modal-header">
            <div class="close-_modal">&#10006;</div>
            <h3>New Contact</h3>
        </div>
        <div class="_modal-body">
            <div class="alert alert-success contact__msg" style="display: none" role="alert">
                Your message was sent successfully.
            </div>
            <form action="#" method="POST" class="base_form contactForm">
                <div class="form_block">
                    <label for="subject" class="label">Subject</label>
                    <input required class="data_field" id="subject"  name="subject" value="" type="text">
                </div>
                <div class="form_block">
                    <label for="msg" class="label">Message</label>
                    <textarea required rows="4"  class="data_field" name="msg"></textarea>
                </div>
                <div class="form_block">
                    <button class="big_button" type="submit">
                        <i class="icon"> 
                            <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-envelope" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1H2zm13 2.383l-4.758 2.855L15 11.114v-5.73zm-.034 6.878L9.271 8.82 8 9.583 6.728 8.82l-5.694 3.44A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.739zM1 11.114l4.758-2.876L1 5.383v5.73z"/>
                            </svg>
                        </i>
                        Send
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
<!-- _modal -->
<div class="_modal" id="_modal-contacts-edit">
    <div class="_modal-sandbox"></div>
    <div class="_modal-box">
        <div class="_modal-header">
            <div class="close-_modal">&#10006;</div>
            <h3>Reply</h3>
        </div>
        <div class="_modal-body">
            <div class="contact__msg"></div>
            <form action="#" method="POST" class="base_form ReplyForm">
                <input type="hidden" value="{{data_detail._id}}" name="_id" />
                <div class="form_block">
                    <label for="msg" class="label">Message</label>
                    <textarea required rows="4"  class="data_field" name="msg"></textarea>
                </div>
                <div class="form_block">
                    <button class="big_button" type="submit">
                        <i class="icon">
                            <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-envelope" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1H2zm13 2.383l-4.758 2.855L15 11.114v-5.73zm-.034 6.878L9.271 8.82 8 9.583 6.728 8.82l-5.694 3.44A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.739zM1 11.114l4.758-2.876L1 5.383v5.73z"/>
                            </svg>
                        </i>
                        Reply
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
<!-- Aditional Styles -->
<style>
._modal,
._modal-box {
  z-index: 10000;
}

._modal-sandbox {
  position: fixed;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  background: transparent;
}

._modal {
  display: none; 
  position: fixed;
  width: 100%;
  height: 100%;
  left: 0;
  top: 0;
  background: rgb(0,0,0);
  background: rgba(0,0,0,.8);
  overflow: auto;
}

._modal-box {
  position: relative;
  width: 80%;
  max-width: 920px;
  margin: 100px auto;
  animation-name: _modalbox;
  animation-duration: 0.5s;
  animation-timing-function: cubic-bezier(0,0,.3,1.6);
}

._modal-header {
  padding: 10px 20px;
  background: #003b66;
  color: #ffffff;
}

._modal-body {
  background: #fff;
  padding: 30px 20px;
}

/* Close Button */
.close-_modal {
    text-align: right;
    cursor: pointer;
    position: absolute;
    right: -10px;
    width: 40px;
    height: 40px;
    top: -10px;
    background: #003b66;
    border: 1px solid #054b7e;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
}

/* Animation */
@-webkit-keyframes _modalbox {
  0% {
    top: -250px; 
    opacity: 0;
  }
  100% {
    top: 0; 
    opacity: 1;
  }
}

@keyframes _modalbox {
  0% {
    top: -250px; 
    opacity: 0;
  }
  100% {
    top: 0; 
    opacity: 1;
  }
}



    /* ============= */
    .mail-box_body .mail-box_list:nth-child(2) {
        background-color: #f9f9f9;
    }

.mail-box_list {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
    padding: 15px 12px;
    cursor: pointer;
    transition: 0.4s;
}
.mail-box_list:hover {
    background: #e4eef7 !important;
}
.mail-box_list.active{
    font-weight: 600;
    background: #87c7f5;
}
.mail-box_list.active:before {
    content: "1";
    padding: 4px;
    width: 10px;
    display: flex;
    justify-content: center;
    height: 10px;
    align-items: center;
    background: #f00;
    border-radius: 100%;
    position: absolute;
    top: 5px;
    left: 4px;
    color: #fff;
}
.mail-box_list-date {
    /* flex-direction: row; */
    /* flex-wrap: nowrap; */
}

.mail-box_list-subject {
    flex: 1;
    max-width: 550px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    margin-right: 5px;
    width: 100%;
}

.mail-box_body {
    width: 100%;
    float: left;
    position: relative;
    overflow: hidden;
    margin-top: 30px;
    border: 1px solid #f0f0f0;
    border-radius: 5px;
    min-height: 100vh;
}

.mail-box {
    width: 100%;
}
.mail-box_content-head {
    padding: 15px;
    border-bottom: 1px solid #f0f0f0;
    font-weight: 600;
}
.mail-box_content-item {
    width: 100%;
    position: relative;
}
.mail-box_body .mail-box_content-item:nth-child(2) {
        background-color: #f9f9f9;
    }
.mail-box_content-name {
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid #f0f0f0;
    padding: 15px;
}
.mail-box_content-name .m_name{
    font-weight: 600;
    display: flex;
    align-items: center;
}
.mail-box_content-detail {
    padding: 15px;
    line-height: 1.5;
    border-bottom: 1px solid #f0f0f0;
    margin-bottom: 10px;
    padding-top: 0;
    margin-top: -20px;
}
.btn_reply{
    padding: 15px;
}
.alert{
    margin-bottom: 10px;
}
.alert-success{
    color: green;
}
.alert-danger{
    color: red;
}
a.view-detail {
    background: #96a0a7;
    color: #fff;
    padding: 2px 10px;
    border-radius: 5px;
    font-size: 13px;
    margin-right: 5px;
}
.mail-box_list.active a.view-detail{
    background: #003a63;
}
</style>
{% endblock content %}
{% block javascripts %}
<script>
$("._modal-trigger").click(function(e){
  e.preventDefault();
  data_modal = $(this).attr("data-_modal");
  $("#" + data_modal).css({"display":"block"});
});

$(".close-_modal, ._modal-sandbox").click(function(){
  $("._modal").css({"display":"none"});
});
$(document).ready(function(){
    $('.mail-box_content-detail').each(function(){
        $(this).html($(this).text().replace(/\n/g,"<br>"))
    })
    var message = $('.contact__msg');
    function done_func(response) {
        message.fadeIn().removeClass('alert-danger').addClass('alert-success');
        message.text("Success");
        setTimeout(function () {
            message.fadeOut();
            $(".close-_modal").trigger("click");
            location.href ="/account/contact-us"
        }, 2000);
        $("form.contactForm").find('input:not([type="submit"]), textarea').val('');
    }
    // fail function
    function fail_func(data) {
        message.fadeIn().removeClass('alert-success').addClass('alert-danger');
        message.text('Error');
        setTimeout(function () {
            message.fadeOut();
        }, 2000);
    }
    $("form.contactForm").submit(function(e) {
        e.preventDefault();
        $.ajax({
            type: 'POST',
            url: "/account/post-new-contact",
            data: $(this).serialize()
        })
        .done(done_func)
        .fail(fail_func);
    });
    $("form.ReplyForm").submit(function(e) {
        e.preventDefault();
        $.ajax({
            type: 'POST',
            url: "/account/post-reply-contact",
            data: $(this).serialize()
        })
        .done(done_func)
        .fail(fail_func);
    });
});
</script>
{% endblock javascripts %}

